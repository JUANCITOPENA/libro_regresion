# Predicción {#predict}
En este capítulo se presenta una descripción breve de como realizar predicciones a partir de un modelo de regresión lineal.

## Función `predict` {-}
La función `predict` es una función genérica de clase S3 que se puede aplicar a un modelo ajustado para obtener los valores de $\hat{y}$. Abajo se muestra la estructura de la función `predict` con la lista de sus argumentos.

```{r eval=FALSE}
predict.lm(object, newdata, se.fit = FALSE, scale = NULL, df = Inf, 
    interval = c("none", "confidence", "prediction"), 
    level = 0.95, type = c("response", "terms"), 
    terms = NULL, na.action = na.pass, pred.var = res.var/weights, 
    weights = 1, ...) 
```

### Ejemplo {-}
Suponga que queremos ajustar un modelo de regresión para explicar el número de trabajadores empleados (Employed) en función de las covariables Unemployed, Armed.Forces y Year del conjunto de datos `longley`. Luego de ajustar el modelo queremos predecir el valor de $\widehat{Employed}$ en dos situaciones:

- Año 1963 con 420 desempleados y 270 personas en fuerzas armadas.
- Año 1964 con 430 desempleados y 250 personas en fuerzas armadas.

__Solución__

Lo primero que se debe hacer es ajustar el modelo así.

```{r}
mod <- lm(Employed ~ Unemployed + Armed.Forces + Year, data=longley)

library(broom)
tidy(mod, quick=TRUE)
```

De la tabla anterior tenemos que el modelo ajustado es el siguiente:

$$
\widehat{\text{Employed}} = -1797.22 - 0.01(\text{Unemployed}) - 0.01(\text{Armed.Forces}) + 0.96(\text{Year}) + \epsilon
$$

Podríamos usar la expresión anterior y reemplazar los valores de año, desempleados y personas en fuerzas armadas, dadas arriba, para calcular $\widehat{Employed}$. Sin embargo, aquí lo vamos a realizar usando la función `predict`.

Lo segundo que debemos hacer es construir un nuevo marco de datos con la información de las covariables, usando los mismos nombres y los mismos tipos de variables (cuali o cuanti) que en el conjunto de datos con el cual se entrenó el modelo.

```{r}
nuevo <- data.frame(Year=c(1963, 1964),
                    Unemployed=c(420, 430),
                    Armed.Forces=c(270, 250))
nuevo
```

Ahora ya podemos usar la función `predict` para obtener lo solicitado.

```{r}
predict(object=mod, newdata=nuevo)
```

De la salida anterior tenemos los valores de $\widehat{Employed}$.

```{block2, type='rmdwarning'}
¿Qué sucede si en el `nuevo` marco de datos anterior las variables se llaman diferente a las variables conjunto de datos de entrenamiento?
  
Error, nos sale un error. No se le ocurra usar nombres diferentes.
```

Supongamos ahora que, además de obtener $\widehat{Employed}$, queremos un intervalo de confianza del 90%. Para obtener esto podemos usar el siguiente código.

```{r}
predict(object=mod, newdata=nuevo, level=0.90, interval="confidence")
```
